<!DOCTYPE html>
<!-- saved from url=(0049)https://hackaday.io/project/3610/logs/sort/newest -->
<html class="no-js wf-lettergothicstd-n7-active wf-proximanova-i3-active wf-proximanova-i4-active wf-proximanova-i7-active wf-proximanova-n3-active wf-proximanova-n4-active wf-proximanova-n7-active wf-active" lang="en" ng-app="buildlogApp"><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <title>Project logs • Z80 Retro Computer (With Graphics) • Hackaday.io</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <link rel="stylesheet" href="./Project logs • Z80 Retro Computer (With Graphics) • Hackaday.io_files/style.css">
    <script async="" src="./Project logs • Z80 Retro Computer (With Graphics) • Hackaday.io_files/analytics.js"></script><script type="text/javascript" src="./Project logs • Z80 Retro Computer (With Graphics) • Hackaday.io_files/ymb0lgk.js"></script>
    <style type="text/css">.tk-proxima-nova{font-family:"proxima-nova",sans-serif;}.tk-letter-gothic-std{font-family:"letter-gothic-std",sans-serif;}</style><link rel="stylesheet" href="./Project logs • Z80 Retro Computer (With Graphics) • Hackaday.io_files/l" media="all"><script type="text/javascript">try{Typekit.load();}catch(e){}</script>
</head>
<body class="logs">

    <!--
############################################################################################
############################################################################################
############################################################################################
#####################Kt;tL#######################################Kti,E######################
#######################;   .###################################G    E#######################
#######################K    f##################################    ;########################
########################Wj   E###############################K:  .W#########################
##########################.  :E##############################:  .L##########################
#########################D    f##############################.   .##########################
########################,     ;##############################     :E#######K################
################f######K      ,##############################      ,######Lt################
################  W###W       i##############################       t####j t################
################:  E#L.        f###########################L.        f#Ki .E################
################j  ;E.          j##########################.         .G;  i#################
#################L               i#######################K                ##################
#################W                E#####################K;               ;##################
###################:               .###################D               :f###################
#####################DLfGD           G####WEEEEKW####W           ;GffGK#####################
##########################i         iD##Kfi    :jKW##D          iE##########################
###########################W      ,G##f            jE#E;       j############################
############################L     D##D              ,##K       W############################
#############################D:  G#W                  K#E,   G##############################
###############################;i#L                    j## ,E###############################
###############################KK#.                     ##iE################################
#################################j                      ;K##################################
################################W                        ,##################################
################################E                         ##################################
###############################Ki                         D#################################
###############################E.                         L#################################
###############################f    iD##W;       D###D    :#################################
###############################i   i######K     K#####K;   #################################
###############################;  .E#######     #######D   #################################
###############################;  L########     ########   #################################
###############################i  G#######K     K#######   #################################
###############################j  L#####E,       fE#####   #################################
###############################D  .E##j            .t##E  ;#################################
###############################E:  ;##.              #Wt  j#################################
################################G   ;t      tWi      t    E#################################
#############################KL##           K#K;          #K:K##############################
#############################i ##:          ###t         j#f ;K#############################
############################:  G#K          #E#L        L##    D############################
###########################D   ;W#:         #;#L        W#K    .############################
#####################KKEKK      :##L        ; ..      :D##.      fKEEK######################
###################t.            ;##G:               ,##E,             tD###################
##################G               E##E               i##;               :###################
#################D                W##W    iL    E.    ###D                ##################
################W,               G###W    tG    K.    ####:               K#################
################;  LW;         ,E#####:  ;W#    #G   f#####;         ;KG  :K################
################  D###E       ;########WW####WW####WW#######W       :####: j################
################ ,#####:      ;##############################       G####E i################
################K#######.     ;##############################      L######WG################
########################f     i##############################     j#########################
#########################W   .D##############################.   i##########################
#########################E   G###############################D   ,##########################
########################G:   #################################j   G#########################
#######################f    K##################################j    W#######################
#####################Kt :iE#####################################KL:  K######################
############################################################################################
############################################################################################
############################################################################################
-->

<div class="header" id="header">
    <div class="container">

        <a href="https://hackaday.io/" title="Hackaday.io Home" class="logo" onclick="CT(this, &#39;Menu&#39;, &#39;Home&#39;); return false;">Hack a Day</a>

        <a href="javascript:void(0);" class="button-menu">Menu</a>

        <ul class="nav" role="navigation">
            <li><a href="https://hackaday.io/projects" class="">Projects</a></li>
            <li><a href="https://hackaday.io/lists" class="">Lists</a></li>
            <li><a href="https://hackaday.io/stack" class="">Stack</a></li>
            <li class="dropdown j-more-open">
                <a href="javascript:void(0)" class="dropdown-link">More <i class="icon-arrowdown"></i></a>
                <ul role="menu" class="dropdown-menu more-menu" id="j-more">
                    <li><a href="http://hackaday.com/blog/" target="_blank">Blog</a></li>
                    <li><a href="https://hackaday.io/events">Events</a></li>
                    <li><a href="https://hackaday.io/hackerspaces">Hackerspaces</a></li>
                    <li><a href="https://hackaday.io/hackers">Profiles</a></li>
                    <li><a href="https://hackaday.io/contests">Contests</a></li>
                    <li><a href="https://hackaday.io/prize" target="_blank">The Hackaday Prize</a></li>
                    <li><a href="https://hackaday.io/submissions/prize2016/list">2016 Prize Entries</a></li>
                    <li><a href="http://store.hackaday.com/" class="j-store-tracking" target="_blank">Store</a></li>
                </ul>
            </li>
            <li class="search-holder">
                <form id="search-form" action="https://hackaday.io/search" onsubmit="return submitSearch();" method="GET">
                    <input type="text" placeholder="Search projects, profiles ..." name="term" class="input-field j-add-search" id="j-add-search" value="" autocomplete="off" pattern=".{2,}" required="" title="2 characters minimum">
                    <button type="submit" class="button-search"><i class="icon-search"></i></button>
                </form>
            </li>
        </ul>

        

            <ul class="nav right nav-signin" role="navigation">
                <li><a href="https://hackaday.io/signup" class="gold-white-button">Sign up</a></li>
                <li><a href="https://hackaday.io/signin?returnUrl=%2Fproject%2F3610%2Flogs%2Fsort%2Fnewest">Log In</a></li>
            </ul>

        
    </div>
</div>

<div id="topMessage" class="alert small hide">
    <span class="j-top-content"></span>
    <a href="javascript:void(0);" class="alert-close j-top-message-close"><i class="icon-close"></i> Close</a>
</div>




    
<div class="project-header-menu">
    <div class="container">

        <div class="project-details">

            <h1><a href="https://hackaday.io/project/3610-z80-retro-computer-with-graphics">Z80 Retro Computer (With Graphics)</a></h1>

            <p class="description-summary">Z80 Single board computer</p>

            <div class="description-metainfo">
                <span class="identity-card" data-id="12113"><a href="https://hackaday.io/Hacker404"><img src="./Project logs • Z80 Retro Computer (With Graphics) • Hackaday.io_files/7074321430968465409.png"> Hacker404</a></span> <!--&bull;
                <span class='time-card' style='margin: 0' title='a year ago'>12/12/2014 at 04:12</span>-->
            </div>

        </div>

    </div>

    <div class="project-menu-holder">
        <ul class="project-menu container">
            <li>
                <a href="https://hackaday.io/project/3610-z80-retro-computer-with-graphics">About</a>
            </li>
            <li class="">
                
                    Files (0)
                
            </li>
            <li class="">
                
                    Components (0)
                
            </li>
            <li class="active">
                
                    <a href="https://hackaday.io/project/3610/logs">Logs (3)</a>
                
            </li>
            <li class="">
                
                    Instructions (0)
                
            </li>
            <li>
                <a href="https://hackaday.io/project/3610-z80-retro-computer-with-graphics#j-discussions-title">Discussion (6)</a>
            </li>
        </ul>
    </div>
</div>

    <div class="container post-content">
        <div class="section-buildsort">
            <span class="pull-left">
                <a href="https://hackaday.io/project/3610-z80-retro-computer-with-graphics">« Back to project details</a>
            </span>
            <span class="sort-holder pull-right">
                <label for="sort-by">Sort by:</label>
                <div class="j-select-holder select-holder" style="position: relative;"><div class="select-text" style="cursor: pointer; opacity: 1;">Newest</div><select class="sort" id="sort-by" data-inited="yes" style="cursor: pointer; opacity: 0; position: absolute; top: 0px; left: 0px; width: 100%;">
                    <option value="/project/3610/logs/sort/newest" selected="selected">Newest</option>
                    <option value="/project/3610/logs/sort/oldest">Oldest</option>
                </select><span class="arrow-icon"></span></div>
            </span>
        </div>
        <div class="section section-buildlogs last">
            

                <ul class="buildlogs-list">
                    
                        <li>
                            <h3 class="element-title">
                                <a href="https://hackaday.io/project/3610/log/16315-made-my-first-pcb">Made my first PCB</a>
                                
                            </h3>
                            <small class="authorship"><span class="time-card" style="margin: 0" title="11 months ago">04/09/2015 at 12:00</span>  •
                                <a class="gray-link" href="https://hackaday.io/project/3610/log/16315#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-16315"><p style="transition: transform 1s ease 0s;">I started designing a PCB in CAD. I realised that it's not so easy to deal with these chips on a single sided board. The routing is a challenge. </p><p style="transition: transform 1s ease 0s;">After a little while I decided that instead I should start with something simple as I have never designed / made a PCB before. </p><p style="transition: transform 1s ease 0s;">I designed a tiny adaptor board to mount a SOJ36 chip on a standard width (0.6") DIP. </p><p style="transition: transform 1s ease 0s;">I chose the SOJ as that's about the hardest thing I am willing to try to solder. and I chose the 0.6" width to make is so cramped that trace widths and spacings are a challenge. I didn't expect it to work out but I did expect to find the limits. </p><p style="transition: transform 1s ease 0s;">The pins aren't in the correct order as there simply isn't enough room on a single sided board. That doesn't matter that much when it connects to CPLD as I can just fix the ordering inside the CPLD. </p><p style="transition: transform 1s ease 0s;">Here's the CAD - </p><p><a href="./Project logs • Z80 Retro Computer (With Graphics) • Hackaday.io_files/5448611428580069761.jpg" target="_blank"><img src="./Project logs • Z80 Retro Computer (With Graphics) • Hackaday.io_files/5448611428580069761.jpg"></a></p><p>The traces are 10 mill and the spacing goes down to 15 mill. </p><p style="transition: transform 1s ease 0s;">Here is the toner and TRF transferred to the board - </p><p><a href="./Project logs • Z80 Retro Computer (With Graphics) • Hackaday.io_files/5048121428580266076.jpg" target="_blank"><img src="./Project logs • Z80 Retro Computer (With Graphics) • Hackaday.io_files/5048121428580266076.jpg"></a></p><p>The TRF didn't bond propperly in some places. I am not sure why. </p><p>Here is the etched / drilled board - </p><p><a href="./Project logs • Z80 Retro Computer (With Graphics) • Hackaday.io_files/9746951428580360965.jpg" target="_blank"><img src="./Project logs • Z80 Retro Computer (With Graphics) • Hackaday.io_files/9746951428580360965.jpg"></a></p><p>It has a few pits but I expected that for a first run. The fact that the TRF was missing in places didn't make any difference. </p><p>I tinned it with a big blob of solder then cleaned it off with solder wick - </p><p><a href="./Project logs • Z80 Retro Computer (With Graphics) • Hackaday.io_files/4067781428580530084.jpg" target="_blank"><img src="./Project logs • Z80 Retro Computer (With Graphics) • Hackaday.io_files/4067781428580530084.jpg"></a></p><p>I soldered the chip on and then the header pins. I then tested for shorts and that everything connects as it should ... all good -</p><p><a href="./Project logs • Z80 Retro Computer (With Graphics) • Hackaday.io_files/3117361428580710542.jpg" target="_blank"><img src="./Project logs • Z80 Retro Computer (With Graphics) • Hackaday.io_files/3117361428580710542.jpg"></a></p><p>After taking this pic I realised how much flux is still under the chip. If I clean that out it may even work!<br></p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h3 class="element-title">
                                <a href="https://hackaday.io/project/3610/log/16314-preparing-to-use-the-altera-cpld">Preparing to use the Altera CPLD</a>
                                
                            </h3>
                            <small class="authorship"><span class="time-card" style="margin: 0" title="11 months ago">04/09/2015 at 11:37</span>  •
                                <a class="gray-link" href="https://hackaday.io/project/3610/log/16314#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-16314"><p>I started checking the Altera CPLD boards I bought on ebay. </p><p>These are the boards - </p><p><a href="./Project logs • Z80 Retro Computer (With Graphics) • Hackaday.io_files/5897171428578535046.jpg" target="_blank"><img src="./Project logs • Z80 Retro Computer (With Graphics) • Hackaday.io_files/5897171428578535046.jpg"></a></p><a href="./Project logs • Z80 Retro Computer (With Graphics) • Hackaday.io_files/3705511428578864825.jpg" target="_blank"><img src="./Project logs • Z80 Retro Computer (With Graphics) • Hackaday.io_files/3705511428578864825.jpg"></a><p>Both boards are identical. The only difference being that one has an EPM240 chip and the other has a EPM570 chip. </p><p>Unfortunately they shouldn't be identical as the EPM570 has four less IO pins. This is because four extra pins are used for core Vcc (2 pins) and core ground (2 Pins). </p><p>There are four 0 Ohm resistors (links) missing on the back of the board. I just used wire links to replace them. R2, R3, R4, R5</p><p style="transition: transform 1s ease 0s;">C1 and R1 are for an asynchronous power up reset. I didn't bother with them as I wont be using them. <br></p><p><a href="./Project logs • Z80 Retro Computer (With Graphics) • Hackaday.io_files/6672791428578935271.jpg" target="_blank"><img src="./Project logs • Z80 Retro Computer (With Graphics) • Hackaday.io_files/6672791428578935271.jpg"></a></p><p>I also noticed an error on the silk screen here - </p><p><a href="./Project logs • Z80 Retro Computer (With Graphics) • Hackaday.io_files/497371428579122885.jpg" target="_blank"><img src="./Project logs • Z80 Retro Computer (With Graphics) • Hackaday.io_files/497371428579122885.jpg"></a></p><p style="transition: transform 1s ease 0s;">What is marked as pin 59 on the silk screen is actually pin 61 of the CPLD. Pin 59 is *not* an IO pin, pin 61 is an IO. </p><p style="transition: transform 1s ease 0s;">I then made a PCB library component to represent the board - <br></p><p><a href="./Project logs • Z80 Retro Computer (With Graphics) • Hackaday.io_files/5047221428579373033.JPG" target="_blank"><img src="./Project logs • Z80 Retro Computer (With Graphics) • Hackaday.io_files/5047221428579373033.JPG"></a></p><p style="transition: transform 1s ease 0s;">So now I am ready to go with making a PCB board (hopefully). <br></p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h3 class="element-title">
                                <a href="https://hackaday.io/project/3610/log/15956-flash-chip-programmer">FLASH Chip Programmer</a>
                                
                            </h3>
                            <small class="authorship"><span class="time-card" style="margin: 0" title="a year ago">04/02/2015 at 02:45</span>  •
                                <a class="gray-link" href="https://hackaday.io/project/3610/log/15956#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-15956"><p>I decided that at some stage I need to get some code into this project. I was previously thinking of using an atmega to load boot code to the CPU and then have the CPU boot to SD card. </p><p>I am not so sure about using an atmega as a co-processor now that I have decide to use a larger Altera EPM570 CPLD (about 440 macro's). </p><p>In any case I need something to get started without going to all the trouble of writing boot loaders. </p><p>I decide to hunt around the house for some FLASH as I haven't purchased any. </p><p>I found 3 x 32 pin PLCC FLASH chips. 2 were in old mother boards and one was in a CD ROM. </p><p>The main board ones were 3.3 Volt only so they were no good to work with a 5 Volt CPU. </p><p>The CD ROM one was 5 Volt but it was soldered in - </p><p><a href="./Project logs • Z80 Retro Computer (With Graphics) • Hackaday.io_files/1446281427940649475.jpg" target="_blank"><img src="./Project logs • Z80 Retro Computer (With Graphics) • Hackaday.io_files/1446281427940649475.jpg"></a></p><p>So I put it (upside down) in an oven tray and heated it until it dropped off the circuit board. </p><p>Then when I looked up the specs I found it has the worst of both worlds lol. It has write protection so you can't flash it like you would with older PROMS (just as if they were slow RAM) and also it has *no* Low Pin Count (LPC) interface so I have to use a full blow parallel interface to program it. </p><p>I don't have a programmer so I started hunting around to something to expand pin count (like serial in parallel out shift registers) but no good. Then I though ... what about the old Xilinx XC9572XL development board. I could connect that to something ending in 'duino. </p><p>As it turned out the the stupid adaptor (dam I hate strip board) that I made was perfect. When I made it, I added extra rows of connectors for different sized breakouts / adaptors. A ZIF socket fitted right in and I had a PLCC32 to DIP adaptor. </p><p><a href="./Project logs • Z80 Retro Computer (With Graphics) • Hackaday.io_files/2689971427941442128.jpg" target="_blank"><img src="./Project logs • Z80 Retro Computer (With Graphics) • Hackaday.io_files/2689971427941442128.jpg"></a></p><p>The stack - </p><p><a href="./Project logs • Z80 Retro Computer (With Graphics) • Hackaday.io_files/6033721427941492212.jpg" target="_blank"><img src="./Project logs • Z80 Retro Computer (With Graphics) • Hackaday.io_files/6033721427941492212.jpg"></a></p><p>The stack from bottom to top - </p><ul><li>Xilinx XC9574XL development board (5 Volt tolerant 72 Macro's)</li><li>The stupid adaptor that I made to allow connecting CPLD to chips etc with jumper lnks. </li><li>ZIF Socket</li><li>PLCC32 to DIP adaptor</li><li>The target FLASH chip</li></ul><p style="transition: transform 1s ease 0s;">I though of perhaps making another adaptor to plug this whole contraption into an Arduino UNO but on second thoughts that could cause problems (Stack Overflow??). </p><p style="transition: transform 1s ease 0s;">Just to see if I got all the connections right and the constraints file right I just quickly changed the old video-out VHDL to work with the FLASH. </p><p style="transition: transform 1s ease 0s;">Here's what I got - </p><p><a href="./Project logs • Z80 Retro Computer (With Graphics) • Hackaday.io_files/997731427941986037.jpg" target="_blank"><img src="./Project logs • Z80 Retro Computer (With Graphics) • Hackaday.io_files/997731427941986037.jpg"></a></p><p>The lines in the picture are because the FLASH chip is much smaller than the SRAM and doesn't have enough room for a full screen. </p><p>Then I wrote some VHDL to use the CPLD board as a big shift register. The code is at the end of the log. </p><p>It's actualy two shift registers. One is A0-A16 (128KB) + CE + OE + WE + Data out D0-D7.</p><p>The second shift register is to read back data from D0-D7. </p><p>It has 4 signals to go to the 'duino. Clock, Load, Data Out, Data In. </p><p style="transition: transform 1s ease 0s;">I am only new to VHDL and I couldn't get LOAD to be asynchronous so it is synchronous to the rising edge of CLOCK. I also had trouble with the tri-state dat bus and I fixed that by using a dedicated 8 bit register. </p><p style="transition: transform 1s ease 0s;">I am now writing the code for the 'duino to program it and I will update that when it works. </p><p style="transition: transform 1s ease 0s;">VHDL - </p><pre class="hljs sql"><span class="hljs-comment"></span>library IEEE;
<span class="hljs-operator"><span class="hljs-keyword">use</span> IEEE.STD_LOGIC_1164.<span class="hljs-keyword">ALL</span>;</span>

<span class="hljs-comment">-- I couldn't get a asynchronious load to work so load ended up syncronised to the rising edge of S_CLOCK</span>
<span class="hljs-comment">-- use process ...</span>

<span class="hljs-comment">-- note shift register does NOT shift when S_LOAD is high</span>
<span class="hljs-comment">-- S_CLOCK is rising edge triggered</span>

<span class="hljs-comment">-- **read flash**</span>
<span class="hljs-comment">-- serial input WE(1),OE(0),CE(0),-,-,-,A0-15</span>
<span class="hljs-comment">-- raise S_LOAD, toggle S_CLOCK</span>
<span class="hljs-comment">-- wait</span>
<span class="hljs-comment">-- toggle S_CLOCK</span>
<span class="hljs-comment">-- lower S_LOAD</span>
<span class="hljs-comment">-- serial read D7 - D0</span>

<span class="hljs-comment">-- **write flash**</span>
<span class="hljs-comment">-- serial input WE(0),OE(1),CE(0),-,-,-,A0-15,D0-7</span>
<span class="hljs-comment">-- raise S_LOAD, toggle S_CLOCK</span>
<span class="hljs-comment">-- wait</span>
<span class="hljs-comment">-- perhaps do a readback to confirm</span>

<span class="hljs-comment">-- **erase flash** as above</span>

entity flash_prog is
    Port (
           <span class="hljs-comment">-- FLASH pins</span>
           CE      : out    STD_LOGIC; <span class="hljs-comment">-- Chip Enable   output to FLASH, active low</span>
             OE      : out    STD_LOGIC; <span class="hljs-comment">-- Output Enable output to FLASH, active low</span>
             WE      : out    STD_LOGIC; <span class="hljs-comment">-- Write Enable  output to FLASH, active low</span>
             A       : out    STD_LOGIC_VECTOR (15 downto 0); <span class="hljs-comment">-- Address bus output to FLASH</span>
             D       : inout  STD_LOGIC_VECTOR (7 downto 0); <span class="hljs-comment">-- bi-directional Data bus to FLASH, controlled by OE</span>
             <span class="hljs-comment">-- Serial pins</span>
             S_LOAD  : in     STD_LOGIC; <span class="hljs-comment">-- Serial Latch Enable 0 = shift, 1 = load (synchronious to S_CLK)</span>
          S_CLOCK : in     STD_LOGIC; <span class="hljs-comment">-- Serial Clock, rising edge triggered</span>
             S_DIN   : in     STD_LOGIC; <span class="hljs-comment">-- Serial Data Input for outputs to FLASH</span>
          S_DOUT  : out    STD_LOGIC <span class="hljs-comment">-- Serial Data Output to read back data bus</span>
             );
<span class="hljs-operator"><span class="hljs-keyword">end</span> flash_prog;</span>

architecture Behavioral of flash_prog is

<span class="hljs-comment">-- signals</span>
          signal serial_reg : STD_LOGIC_VECTOR (29 downto 0); <span class="hljs-comment">-- serial register that is copied to latch reg</span>
             signal latch_reg  : STD_LOGIC_VECTOR (29 downto 0); <span class="hljs-comment">-- all outputs to FLASH</span>
             signal data_reg   : STD_LOGIC_VECTOR (7 downto 0); <span class="hljs-comment">-- reads back from data bus</span>
      <span class="hljs-comment">-- serial_reg and latch_reg</span>
      <span class="hljs-comment">-- (0 to 15)  - A(0 to 15)</span>
      <span class="hljs-comment">-- (16)       - A(16) not implemented</span>
      <span class="hljs-comment">-- (17)       - A(17) not implemented</span>
      <span class="hljs-comment">-- (18)       - A(18) not implemented</span>
      <span class="hljs-comment">-- (19)       - CE active low</span>
      <span class="hljs-comment">-- (20)       - OE active low</span>
      <span class="hljs-comment">-- (21)       - WE active low</span>
      <span class="hljs-comment">-- (22 to 29) - D(0 to 7) for output only</span>
      <span class="hljs-comment">-- S_DI =&gt; A0 - A15, -, -, -, CE, OE, WE, D0 - D7</span>
      <span class="hljs-comment">-- '0' =&gt; D0 - D7 =&gt; S_DO</span>

<span class="hljs-operator"><span class="hljs-keyword">begin</span>

process (S_CLOCK, S_LOAD)
  <span class="hljs-keyword">begin</span>
  <span class="hljs-keyword">if</span> (S_CLOCK<span class="hljs-string">'EVENT AND S_CLOCK = '</span><span class="hljs-number">1</span><span class="hljs-string">') then -- rising edge
    if (S_LOAD = '</span><span class="hljs-number">0</span><span class="hljs-string">') then -- shift
       serial_reg(29 downto 1) &lt;= serial_reg(28 downto 0);
        serial_reg(0) &lt;= S_DIN;
        data_reg(7 downto 1) &lt;= data_reg(6 downto 0);
        data_reg(0) &lt;= '</span><span class="hljs-number">0</span><span class="hljs-string">';
     else -- latch
       latch_reg(29 downto 0) &lt;= serial_reg(29 downto 0);
        data_reg(7 downto 0) &lt;= D(7 downto 0);
     end if;
  end if;
end process;


-- serial interface
  S_DOUT &lt;= data_reg(7);

-- FLASH interface
  CE &lt;= latch_reg(19);
  OE &lt;= latch_reg(20);
  WE &lt;= latch_reg(21);
  A(15 downto 0) &lt;= latch_reg(15 downto 0);

-- tristate data bus
  D(7 downto 0) &lt;= latch_reg(29 downto 22)
  when (latch_reg(20) = '</span><span class="hljs-number">1</span><span class="hljs-string">')
  else "ZZZZZZZZ";



end Behavioral;

</span></span></pre><p style="transition: transform 1s ease 0s;">Constraints (Xilinx Format) - </p><pre class="hljs nginx"><span class="hljs-comment"># Constraints for SST 39SF512 FLASH EEPROM (64K x 8, 5V, 70ns)</span>


<span class="hljs-comment"># 3.3 Volts</span>
<span class="hljs-comment">#   5 Volts</span>
<span class="hljs-comment">#NET "CLK"        LOC = "p1";</span>
<span class="hljs-comment">#NET ""        LOC = "p2";</span>
<span class="hljs-title">NET</span> <span class="hljs-string">"A(15)"</span>        LOC = <span class="hljs-string">"p3"</span>;
<span class="hljs-title">NET</span> <span class="hljs-string">"A(12)"</span>        LOC = <span class="hljs-string">"p5"</span>;
<span class="hljs-title">NET</span> <span class="hljs-string">"A(7)"</span>        LOC = <span class="hljs-string">"p6"</span>;
<span class="hljs-title">NET</span> <span class="hljs-string">"A(6)"</span>        LOC = <span class="hljs-string">"p7"</span>;
<span class="hljs-title">NET</span> <span class="hljs-string">"A(5)"</span>        LOC = <span class="hljs-string">"p8"</span>;
<span class="hljs-title">NET</span> <span class="hljs-string">"A(4)"</span>        LOC = <span class="hljs-string">"p12"</span>;
<span class="hljs-title">NET</span> <span class="hljs-string">"A(3)"</span>        LOC = <span class="hljs-string">"p13"</span>;
<span class="hljs-title">NET</span> <span class="hljs-string">"A(2)"</span>        LOC = <span class="hljs-string">"p14"</span>;
<span class="hljs-title">NET</span> <span class="hljs-string">"A(1)"</span>        LOC = <span class="hljs-string">"p16"</span>;
<span class="hljs-title">NET</span> <span class="hljs-string">"A(0)"</span>        LOC = <span class="hljs-string">"p18"</span>;
<span class="hljs-title">NET</span> <span class="hljs-string">"D(0)"</span>        LOC = <span class="hljs-string">"p19"</span>;
<span class="hljs-title">NET</span> <span class="hljs-string">"D(1)"</span>        LOC = <span class="hljs-string">"p20"</span>;
<span class="hljs-title">NET</span> <span class="hljs-string">"D(2)"</span>        LOC = <span class="hljs-string">"p21"</span>;
<span class="hljs-title">NET</span> <span class="hljs-string">"S_CLOCK"</span>    LOC = <span class="hljs-string">"p22"</span>;
<span class="hljs-title">NET</span> <span class="hljs-string">"S_LOAD"</span>    LOC = <span class="hljs-string">"p23"</span>;
<span class="hljs-comment"># GND</span>

<span class="hljs-comment"># GND</span>
<span class="hljs-title">NET</span> <span class="hljs-string">"S_DIN"</span>        LOC = <span class="hljs-string">"p44"</span>;
<span class="hljs-title">NET</span> <span class="hljs-string">"S_DOUT"</span>    LOC = <span class="hljs-string">"p43"</span>;
<span class="hljs-title">NET</span> <span class="hljs-string">"WE"</span>            LOC = <span class="hljs-string">"p42"</span>;
<span class="hljs-comment">#NET ""            LOC = "p41";</span>
<span class="hljs-title">NET</span> <span class="hljs-string">"A(14)"</span>        LOC = <span class="hljs-string">"p40"</span>;
<span class="hljs-title">NET</span> <span class="hljs-string">"A(13)"</span>        LOC = <span class="hljs-string">"p39"</span>;
<span class="hljs-title">NET</span> <span class="hljs-string">"A(8)"</span>        LOC = <span class="hljs-string">"p38"</span>;
<span class="hljs-title">NET</span> <span class="hljs-string">"A(9)"</span>        LOC = <span class="hljs-string">"p37"</span>;
<span class="hljs-title">NET</span> <span class="hljs-string">"A(11)"</span>        LOC = <span class="hljs-string">"p36"</span>;
<span class="hljs-title">NET</span> <span class="hljs-string">"OE"</span>        LOC = <span class="hljs-string">"p34"</span>;
<span class="hljs-title">NET</span> <span class="hljs-string">"A(10)"</span>        LOC = <span class="hljs-string">"p33"</span>;
<span class="hljs-title">NET</span> <span class="hljs-string">"CE"</span>        LOC = <span class="hljs-string">"p32"</span>;
<span class="hljs-title">NET</span> <span class="hljs-string">"D(7)"</span>        LOC = <span class="hljs-string">"p31"</span>;
<span class="hljs-title">NET</span> <span class="hljs-string">"D(6)"</span>        LOC = <span class="hljs-string">"p30"</span>;
<span class="hljs-title">NET</span> <span class="hljs-string">"D(5)"</span>        LOC = <span class="hljs-string">"p29"</span>;
<span class="hljs-title">NET</span> <span class="hljs-string">"D(4)"</span>        LOC = <span class="hljs-string">"p28"</span>;
<span class="hljs-title">NET</span> <span class="hljs-string">"D(3)"</span>        LOC = <span class="hljs-string">"p27"</span>;
<span class="hljs-comment">#   5 Volts</span>
<span class="hljs-comment"># 3.3 Volts</span></pre><p>Well!, In the constraints file (above) I had A(1) and A(2) repeated. The second A(1), A(2) should have been D(1), D(2). That took a long time to find. </p><p> Here's the 'duino code. It's just Proof of Concept but it works. It needs a verify. </p><pre class="hljs http"><span class="http">

<span class="cs"><span class="hljs-preprocessor">#<span class="hljs-keyword">define</span> S_CLOCK 2</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">define</span> S_LOAD  3</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">define</span> S_DIN   4</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">define</span> S_DOUT  5</span>


<span class="hljs-comment">/*
-- note shift register does NOT shift when S_LOAD is high
-- S_CLOCK is rising edge triggered

-- **read flash**
-- serial input WE(1),OE(0),CE(0),-,-,-,A0-15
-- raise S_LOAD, toggle S_CLOCK
-- wait
-- toggle S_CLOCK
-- lower S_LOAD
-- serial read D7 - D0

-- **write flash**
-- serial input D0-7, WE(0), OE(1), CE(0), -, -, -, A0-15
-- raise S_LOAD, toggle S_CLOCK
-- wait
-- perhaps do a readback to confirm

-- **erase flash** as above
*/</span>

<span class="hljs-keyword">char</span> hx[] = <span class="hljs-string">"0123456789ABCDEF"</span>;

<span class="hljs-keyword">byte</span> values[<span class="hljs-number">256</span>];

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">to_hex</span><span class="hljs-params">(<span class="hljs-keyword">long</span> dec, <span class="hljs-keyword">int</span> digits)</span>
  </span>{
  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> index = <span class="hljs-number">0</span>; index &lt; digits; index++)
    {
    hx[digits - index - <span class="hljs-number">1</span>] = to_hex_digit(dec &amp; <span class="hljs-number">15</span>);
    dec = dec &gt;&gt; <span class="hljs-number">4</span>;
    }
  hx[digits] = <span class="hljs-number">0</span>;
  }


<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">to_hex_digit</span><span class="hljs-params">(<span class="hljs-keyword">int</span> dec)</span>
  </span>{
  dec = dec &amp; <span class="hljs-number">15</span>;
  dec = dec + <span class="hljs-number">48</span>;
  <span class="hljs-keyword">if</span>(dec &gt; <span class="hljs-number">57</span>)
    {
    dec = dec + <span class="hljs-number">7</span>;
    }
  <span class="hljs-keyword">return</span> dec;
  }





<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span>
  </span>{
  pinMode(S_CLOCK, OUTPUT);
  pinMode(S_LOAD, OUTPUT);
  pinMode(S_DOUT, INPUT);
  pinMode(S_DIN, OUTPUT);
  Serial.begin(<span class="hljs-number">115200</span>);
  delay(<span class="hljs-number">100</span>);
  }





<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span>
  </span>{
  <span class="hljs-comment">//blink_A15();</span>
  <span class="hljs-keyword">long</span> mem_start = <span class="hljs-number">0</span>;
  <span class="hljs-comment">//sector_erase(13);</span>
  chip_erase();
  <span class="hljs-comment">//write_address(0x13, 0xAB);</span>
  <span class="hljs-comment">//write_address(mem_start, 0);</span>
  <span class="hljs-comment">//write_address(mem_start+1, 255);</span>
  <span class="hljs-comment">//      data, WE, OE, CE, address</span>
  <span class="hljs-keyword">long</span> mem_count = <span class="hljs-number">65536</span>;
  <span class="hljs-keyword">int</span> show_address_counter = <span class="hljs-number">63</span>;
  serial_out(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>);
  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">long</span> address = mem_start; address &lt; (mem_start + mem_count); address++)
    {
    show_address_counter++;
    <span class="hljs-keyword">if</span>(show_address_counter == <span class="hljs-number">64</span>)
      {
      show_address_counter = <span class="hljs-number">0</span>;
      to_hex(address, <span class="hljs-number">4</span>);
      Serial.println(<span class="hljs-string">""</span>);
      Serial.print(hx);
      Serial.print(<span class="hljs-string">"  "</span>);
      }
    <span class="hljs-keyword">int</span> one_byte = read_address(address);
    values[one_byte] = <span class="hljs-number">1</span>;
    to_hex(one_byte, <span class="hljs-number">2</span>);
    Serial.print(hx);
    Serial.print(<span class="hljs-string">""</span>);
    <span class="hljs-comment">//address = address + 15;</span>
    }
  Serial.println(<span class="hljs-string">""</span>);
  Serial.println(<span class="hljs-string">"0123456789ABCDEF"</span>);
  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> index1 = <span class="hljs-number">0</span>; index1 &lt; <span class="hljs-number">16</span>; index1++)
    {
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> index2 = <span class="hljs-number">0</span>; index2 &lt; <span class="hljs-number">16</span>; index2++)
      {
      <span class="hljs-keyword">int</span> dec = index1 * <span class="hljs-number">16</span> + index2;
      <span class="hljs-keyword">if</span>(values[dec] != <span class="hljs-number">1</span>)
        {
        Serial.print(<span class="hljs-string">"X"</span>);
        }
      <span class="hljs-keyword">else</span>
        {
        Serial.print(<span class="hljs-string">"."</span>);
        }
      }
    Serial.println(<span class="hljs-string">""</span>);
    }
  <span class="hljs-keyword">for</span>(; <span class="hljs-number">1</span> == <span class="hljs-number">1</span>;){}
  }








<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">signal_delay</span><span class="hljs-params">()</span>
  </span>{
  <span class="hljs-comment">//  This may be needed for long wire connections</span>
  <span class="hljs-comment">//delayMicroseconds(10);</span>
  }


<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">sector_erase_delay</span><span class="hljs-params">()</span>
  </span>{
  delay(<span class="hljs-number">20</span>); <span class="hljs-comment">// 10mS</span>
  }


<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">chip_erase_delay</span><span class="hljs-params">()</span>
  </span>{
  delay(<span class="hljs-number">40</span>); <span class="hljs-comment">// 20mS</span>
  }

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">write_delay</span><span class="hljs-params">()</span>
  </span>{
  delayMicroseconds(<span class="hljs-number">60</span>);
  }


<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">toggle_S_CLOCK</span><span class="hljs-params">()</span>
  </span>{
  digitalWrite(S_CLOCK, HIGH);
  signal_delay();
  digitalWrite(S_CLOCK, LOW);
  signal_delay();
  }


<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">toggle_S_LOAD</span><span class="hljs-params">()</span>
  </span>{
  digitalWrite(S_LOAD, HIGH);
  signal_delay();
  toggle_S_CLOCK();
  digitalWrite(S_LOAD, LOW);
  signal_delay();
  }


<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">serial_in_bit</span><span class="hljs-params">()</span>
  </span>{
  <span class="hljs-keyword">int</span> one_bit;
  <span class="hljs-keyword">if</span>(digitalRead(S_DOUT) == LOW)
    {
    one_bit = <span class="hljs-number">0</span>;
    }
  <span class="hljs-keyword">else</span>
    {
    one_bit = <span class="hljs-number">1</span>;
    }
  toggle_S_CLOCK();
  <span class="hljs-keyword">return</span> one_bit;
  }


<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">serial_in_byte</span><span class="hljs-params">()</span>
  </span>{
  <span class="hljs-keyword">int</span> one_byte;
  <span class="hljs-keyword">int</span> one_bit;
  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> index = <span class="hljs-number">7</span>; index &gt;= <span class="hljs-number">0</span>; index--)
    {
    one_bit = serial_in_bit();
    one_byte = (one_byte | (one_bit &lt;&lt; index));
    }
  <span class="hljs-keyword">return</span> one_byte;
  }


<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">serial_out_bit</span><span class="hljs-params">(<span class="hljs-keyword">int</span> one_bit)</span>
  </span>{
  <span class="hljs-keyword">if</span>(one_bit == <span class="hljs-number">0</span>)
    {
    digitalWrite(S_DIN, LOW);
    }
  <span class="hljs-keyword">else</span>
    {
    digitalWrite(S_DIN, HIGH);
    }
  toggle_S_CLOCK();
  }


<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">serial_out</span><span class="hljs-params">(<span class="hljs-keyword">int</span> data, <span class="hljs-keyword">int</span> we, <span class="hljs-keyword">int</span> oe, <span class="hljs-keyword">int</span> ce, <span class="hljs-keyword">long</span> add)</span>
  </span>{
  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> index = <span class="hljs-number">7</span>; index &gt;= <span class="hljs-number">0</span>; index--)
    {
    <span class="hljs-keyword">int</span> one_bit = (data &amp; (<span class="hljs-number">1</span> &lt;&lt; index));
    serial_out_bit(one_bit);
    }
  serial_out_bit(we);
  serial_out_bit(oe);
  serial_out_bit(ce);
  serial_out_bit(<span class="hljs-number">0</span>);
  serial_out_bit(<span class="hljs-number">0</span>);
  serial_out_bit(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> index = <span class="hljs-number">15</span>; index &gt;= <span class="hljs-number">0</span>; index--)
    {
    <span class="hljs-keyword">int</span> one_bit = (add &amp; (<span class="hljs-number">1</span> &lt;&lt; index));
    serial_out_bit(one_bit);
    }
  toggle_S_LOAD();
  }


<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">read_address</span><span class="hljs-params">(<span class="hljs-keyword">long</span> add)</span>
  </span>{
  <span class="hljs-keyword">int</span> one_byte;
  <span class="hljs-comment">//      data, WE, OE, CE, address</span>
  <span class="hljs-comment">//serial_out(0, 1, 1, 1, 0);</span>
  <span class="hljs-comment">//serial_out(0, 1, 0, 0, add);</span>
  <span class="hljs-comment">//serial_out(0, 1, 0, 0, add);</span>
  serial_out(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, add);
  toggle_S_LOAD();
  one_byte = serial_in_byte();
  <span class="hljs-keyword">return</span> one_byte;
  }


<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">write_address</span><span class="hljs-params">(<span class="hljs-keyword">long</span> add, <span class="hljs-keyword">int</span> data)</span>
  </span>{
  <span class="hljs-comment">//      data, WE, OE, CE, address</span>
  serial_out(<span class="hljs-number">0xAA</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0x5555</span>);
  serial_out(<span class="hljs-number">0xAA</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0x5555</span>);
  
  serial_out(<span class="hljs-number">0x55</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0x2AAA</span>);
  serial_out(<span class="hljs-number">0x55</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0x2AAA</span>);
  
  serial_out(<span class="hljs-number">0xA0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0x5555</span>);
  serial_out(<span class="hljs-number">0xA0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0x5555</span>);
  
  serial_out(data, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, add);
  serial_out(data, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, add);
  
  serial_out(data, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, add);
  
  write_delay();
  }


<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">sector_erase</span><span class="hljs-params">(<span class="hljs-keyword">int</span> sector)</span>
  </span>{
  sector = sector &amp; <span class="hljs-number">15</span>;
  sector = (sector &lt;&lt; <span class="hljs-number">12</span>);
  <span class="hljs-comment">//      data, WE, OE, CE, address</span>
  serial_out(<span class="hljs-number">0xAA</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0x5555</span>);
  serial_out(<span class="hljs-number">0xAA</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0x5555</span>);
  
  serial_out(<span class="hljs-number">0x55</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0x2AAA</span>);
  serial_out(<span class="hljs-number">0x55</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0x2AAA</span>);
  
  serial_out(<span class="hljs-number">0x80</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0x5555</span>);
  serial_out(<span class="hljs-number">0x80</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0x5555</span>);
  
  serial_out(<span class="hljs-number">0xAA</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0x5555</span>);
  serial_out(<span class="hljs-number">0xAA</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0x5555</span>);
  
  serial_out(<span class="hljs-number">0x55</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0x2AAA</span>);
  serial_out(<span class="hljs-number">0x55</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0x2AAA</span>);
  
  serial_out(<span class="hljs-number">0x30</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, sector);
  serial_out(<span class="hljs-number">0x30</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, sector);
  
  serial_out(<span class="hljs-number">0x30</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, sector);
  
  sector_erase_delay();
  }


<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">chip_erase</span><span class="hljs-params">()</span>
  </span>{
  serial_out(<span class="hljs-number">0xAA</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0x5555</span>);
  serial_out(<span class="hljs-number">0xAA</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0x5555</span>);
  
  serial_out(<span class="hljs-number">0x55</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0x2AAA</span>);
  serial_out(<span class="hljs-number">0x55</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0x2AAA</span>);
  
  serial_out(<span class="hljs-number">0x80</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0x5555</span>);
  serial_out(<span class="hljs-number">0x80</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0x5555</span>);
  
  serial_out(<span class="hljs-number">0xAA</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0x5555</span>);
  serial_out(<span class="hljs-number">0xAA</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0x5555</span>);
  
  serial_out(<span class="hljs-number">0x55</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0x2AAA</span>);
  serial_out(<span class="hljs-number">0x55</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0x2AAA</span>);
  
  serial_out(<span class="hljs-number">0x10</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0x5555</span>);
  serial_out(<span class="hljs-number">0x10</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0x5555</span>);
  
  serial_out(<span class="hljs-number">0x10</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0x5555</span>);
  
  chip_erase_delay();
  }


<span class="hljs-keyword">byte</span> data[] = {<span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>} <span class="hljs-comment">// truncated this line was 16,000 Bytes</span>



<span class="hljs-comment">/*

// some diagnostic routines


void blink_WE()
  {
  //      data, WE, OE, CE, address
  for(; 1 == 1;)
    {
    serial_out(0, 0, 1, 1, 0);
    delay(200);
    serial_out(0, 1, 1, 1, 0);
    delay(200);
    }
  }


void blink_OE()
  {
  //      data, WE, OE, CE, address
  for(; 1 == 1;)
    {
    serial_out(0, 1, 0, 1, 0);
    delay(200);
    serial_out(0, 1, 1, 1, 0);
    delay(200);
    }
  }


void blink_CE()
  {
  //      data, WE, OE, CE, address
  for(; 1 == 1;)
    {
    serial_out(0, 1, 1, 0, 0);
    delay(200);
    serial_out(0, 1, 1, 1, 0);
    delay(200);
    }
  }


void blink_D0()
  {
  //      data, WE, OE, CE, address
  for(; 1 == 1;)
    {
    serial_out(1, 1, 1, 1, 0);
    delay(200);
    serial_out(0, 1, 1, 1, 0);
    delay(200);
    }
  }


void blink_D7()
  {
  //      data, WE, OE, CE, address
  for(; 1 == 1;)
    {
    serial_out(128, 1, 1, 1, 0);
    delay(200);
    serial_out(0, 1, 1, 1, 0);
    delay(200);
    }
  }


void blink_A0()
  {
  //      data, WE, OE, CE, address
  for(; 1 == 1;)
    {
    serial_out(0, 1, 1, 1, 1);
    delay(200);
    serial_out(0, 1, 1, 1, 0);
    delay(200);
    }
  }


void blink_A15()
  {
  //      data, WE, OE, CE, address
  for(; 1 == 1;)
    {
    serial_out(0, 1, 1, 1, 32768);
    delay(200);
    serial_out(0, 1, 1, 1, 0);
    delay(200);
    }
  }
*/</span>
</span></span></pre>
<p> I will modify the VHDL so that it works with larger FLASH chips. The existing VHDL works for a 64KB (512Kb) chip. I will add 3 addresses so it can do 128KB (1Mb), 256KB (2Mb) and 512KB (4Mb) chips as well. I want to use a 512KB (4Mb) chips but I haven't yet found a 5 Volt version, perhaps they don't exist. </p><p>I will also modify the 'duino code for larger chips and fix it up. I want to see if I can simply drop files into the serial monitor and program that way. I can only store 16KB in the 'duino flash so it takes 4 sessions just to program 64KB. <br></p></div>
                            </div>
                        </li>
                    
                </ul>

                

                

                <p></p>

            
        </div>
    </div>

    











<div id="footer" class="footer">
    <a href="https://hackaday.io/project/3610/logs/sort/newest#header" class="back-to-top" onclick="CT(this, &#39;Footer&#39;, &#39;GoingUp&#39;);"><i class="icon-longarrowup"></i> Going up?</a>
    <p>
        <a href="http://hackaday.com/about/">About Us</a>
        <a href="mailto:projects-contact@hackaday.com">Contact Hackaday.io</a>
        <a href="https://hackaday.io/project/37">Give Feedback</a> <a href="https://hackaday.io/tos">Terms of Use</a>
        <a href="https://hackaday.io/privacy-policy">Privacy Policy</a>
        <a href="https://dev.hackaday.io/" target="_blank">Hackaday API</a>
    </p>
    <p><a href="https://hackaday.io/" onclick="CT(this, &#39;Footer&#39;, &#39;Home&#39; ); return false;"><i class="icon-skull"></i> © 2016 Hackaday</a></p>
</div>

<script>
    var csrftoken = 'OCtonP4V-vk3iykih6hq9KeoAHHGPQnubbZE';
</script>

    <script type="text/javascript">

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-47229708-1', 'auto');

    var dimensionValue = 'nonregistered';
    ga('set', 'dimension1', dimensionValue);
    ga('require', 'displayfeatures');

    ga('send', 'pageview');

    </script>

<img src="./Project logs • Z80 Retro Computer (With Graphics) • Hackaday.io_files/impression" class="sf-impression">

    
    
    <script src="./Project logs • Z80 Retro Computer (With Graphics) • Hackaday.io_files/h-ydgsYIeDTf7pqgYQEKK8Ngblw0IkZCDqfJ9S2tk7zsBoxIHt5iOd49Qp+F4vdxEuRj+GpGDLbX4aGOQGmbjaOxUZvklg4ReFk68R95OQshFrGKebvogKGQOiB5Hi1xym9.js"></script>



</body></html>